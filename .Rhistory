summarise(total = sum(crime_count), .groups = "drop") %>%
arrange(desc(total)) %>%
head(10)
# Top crime types
crime %>%
group_by(crime_type) %>%
summarise(total = sum(crime_count), .groups = "drop") %>%
arrange(desc(total)) %>%
head(10)
# ============================================
# 01_data_cleaning.R
# Final Data Preprocessing (NCRB Dataset)
# ============================================
library(tidyverse)
# --------------------------------------------
# Load raw NCRB dataset (wide format)
# --------------------------------------------
crime_raw <- read_csv("data/dataset.csv", show_col_types = FALSE)
# --------------------------------------------
# Identify crime columns (exclude identifiers)
# --------------------------------------------
crime_cols <- setdiff(
colnames(crime_raw),
c("STATE/UT", "DISTRICT", "YEAR")
)
# --------------------------------------------
# Convert WIDE → LONG (tidy format)
# --------------------------------------------
crime_clean <- crime_raw %>%
pivot_longer(
cols = all_of(crime_cols),
names_to = "crime_type",
values_to = "crime_count"
) %>%
mutate(
crime_count = as.numeric(crime_count)
) %>%
filter(!is.na(crime_count))
# --------------------------------------------
# REMOVE AGGREGATE IPC CATEGORIES (CRITICAL)
# --------------------------------------------
crime_clean <- crime_clean %>%
filter(!crime_type %in% c(
"TOTAL IPC CRIMES",
"OTHER IPC CRIMES"
))
# --------------------------------------------
# Final sanity checks (optional)
# --------------------------------------------
stopifnot(
all(c("STATE/UT", "DISTRICT", "YEAR", "crime_type", "crime_count") %in% colnames(crime_clean)),
is.numeric(crime_clean$crime_count),
is.numeric(crime_clean$YEAR)
)
# --------------------------------------------
# Save cleaned dataset (FINAL MASTER FILE)
# --------------------------------------------
write_csv(crime_clean, "data/cleaned_crime_data.csv")
# ============================================
# 01_data_cleaning.R
# Final Data Preprocessing (NCRB Dataset)
# ============================================
library(tidyverse)
# --------------------------------------------
# Load raw NCRB dataset (wide format)
# --------------------------------------------
crime_raw <- read_csv("data/dataset.csv", show_col_types = FALSE)
# --------------------------------------------
# Identify crime columns (exclude identifiers)
# --------------------------------------------
crime_cols <- setdiff(
colnames(crime_raw),
c("STATE/UT", "DISTRICT", "YEAR")
)
# --------------------------------------------
# Convert WIDE → LONG (tidy format)
# --------------------------------------------
crime_clean <- crime_raw %>%
pivot_longer(
cols = all_of(crime_cols),
names_to = "crime_type",
values_to = "crime_count"
) %>%
mutate(
crime_count = as.numeric(crime_count)
) %>%
filter(!is.na(crime_count))
# --------------------------------------------
# REMOVE AGGREGATE IPC CATEGORIES (CRITICAL)
# --------------------------------------------
crime_clean <- crime_clean %>%
filter(!crime_type %in% c(
"TOTAL IPC CRIMES",
"OTHER IPC CRIMES"
))
# --------------------------------------------
# Final sanity checks (optional)
# --------------------------------------------
stopifnot(
all(c("STATE/UT", "DISTRICT", "YEAR", "crime_type", "crime_count") %in% colnames(crime_clean)),
is.numeric(crime_clean$crime_count),
is.numeric(crime_clean$YEAR)
)
# --------------------------------------------
# Save cleaned dataset (FINAL MASTER FILE)
# --------------------------------------------
write_csv(crime_clean, "data/cleaned_crime_data.csv")
# ===============================
# 02_eda.R
# Exploratory Data Analysis
# ===============================
library(tidyverse)
crime <- read_csv("data/cleaned_crime_data.csv")
crime <- crime %>%
filter(!crime_type %in% c(
"TOTAL IPC CRIMES",
"OTHER IPC CRIMES"
))
# Structure
str(crime)
# Dimensions
dim(crime)
# Year range
range(crime$YEAR)
length(unique(crime$YEAR))
# Missing values
colSums(is.na(crime))
# Distribution
summary(crime$crime_count)
# Top states by crime
crime %>%
group_by(`STATE/UT`) %>%
summarise(total = sum(crime_count), .groups = "drop") %>%
arrange(desc(total)) %>%
head(10)
# Top crime types
crime %>%
group_by(crime_type) %>%
summarise(total = sum(crime_count), .groups = "drop") %>%
arrange(desc(total)) %>%
head(10)
library(tidyverse)
library(ggplot2)
crime <- read_csv("data/cleaned_crime_data.csv")
yearly <- crime %>%
group_by(YEAR) %>%
summarise(total = sum(crime_count), .groups = "drop")
yearly <- crime %>%
group_by(YEAR) %>%
summarise(total = sum(crime_count), .groups = "drop")
ggplot(yearly, aes(YEAR, total)) +
geom_line(color = "firebrick", linewidth = 1) +
geom_point() +
scale_x_continuous(breaks = sort(unique(yearly$YEAR))) +
labs(
title = "Year-wise Crime Trend in India",
x = "Year",
y = "Total Crimes"
) +
theme_minimal()
top_states <- crime %>%
group_by(`STATE/UT`) %>%
summarise(total = sum(crime_count), .groups = "drop") %>%
arrange(desc(total)) %>%
slice_head(n = 10)
ggplot(top_states,
aes(x = reorder(`STATE/UT`, total), y = total)) +
geom_col(fill = "steelblue") +
coord_flip() +
labs(
title = "Top 10 States by Crime",
x = "State",
y = "Total Crimes"
) +
theme_minimal()
top_crimes <- crime %>%
group_by(crime_type) %>%
summarise(total = sum(crime_count), .groups = "drop") %>%
arrange(desc(total)) %>%
slice_head(n = 10)
ggplot(top_crimes,
aes(x = reorder(crime_type, total), y = total)) +
geom_col(fill = "darkorange") +
coord_flip() +
labs(
title = "Top 10 Crime Types in India",
x = "Crime Type",
y = "Total Crimes"
) +
theme_minimal()
# ============================================
# app.R
# NCRB Crime Analysis Dashboard (Final Dataset)
# ============================================
library(shiny)
library(tidyverse)
library(ggplot2)
# --------------------------------------------
# Load cleaned crime dataset
# --------------------------------------------
crime <- read_csv("data/cleaned_crime_data.csv", show_col_types = FALSE)
# --------------------------------------------
# UI
# --------------------------------------------
ui <- fluidPage(
titlePanel("India Crime Analysis Dashboard (NCRB Data)"),
sidebarLayout(
sidebarPanel(
selectInput(
"state",
"Select State / UT:",
choices = sort(unique(crime$`STATE/UT`)),
selected = unique(crime$`STATE/UT`)[1]
),
selectInput(
"crime_type",
"Select Crime Type:",
choices = c("All", sort(unique(crime$crime_type))),
selected = "All"
),
sliderInput(
"year",
"Select Year Range:",
min = min(crime$YEAR),
max = max(crime$YEAR),
value = c(min(crime$YEAR), max(crime$YEAR)),
sep = ""
)
),
mainPanel(
tabsetPanel(
tabPanel(
"Overview",
h4("Year-wise Crime Trend (India)"),
plotOutput("yearPlot", height = "350px"),
br(),
h4("Top Crime Types"),
plotOutput("crimeTypePlot", height = "350px")
),
tabPanel(
"State-wise Analysis",
h4("Crime Trend for Selected State"),
plotOutput("stateTrendPlot", height = "350px"),
br(),
h4("Crime Distribution by Type"),
plotOutput("stateCrimeTypePlot", height = "350px")
)
)
)
)
)
# --------------------------------------------
# Server
# --------------------------------------------
server <- function(input, output) {
# Reactive filtered dataset
filtered_data <- reactive({
data <- crime %>%
filter(
`STATE/UT` == input$state,
YEAR >= input$year[1],
YEAR <= input$year[2]
)
if (input$crime_type != "All") {
data <- data %>% filter(crime_type == input$crime_type)
}
data
})
# ------------------------------------------
# 1. Year-wise crime trend (India)
# ------------------------------------------
output$yearPlot <- renderPlot({
crime %>%
filter(
YEAR >= input$year[1],
YEAR <= input$year[2]
) %>%
group_by(YEAR) %>%
summarise(total = sum(crime_count), .groups = "drop") %>%
ggplot(aes(YEAR, total)) +
geom_line(color = "firebrick", linewidth = 1) +
geom_point() +
scale_x_continuous(breaks = sort(unique(crime$YEAR))) +
labs(
x = "Year",
y = "Total Crimes"
) +
theme_minimal()
})
# ------------------------------------------
# 2. Top crime types (India)
# ------------------------------------------
output$crimeTypePlot <- renderPlot({
crime %>%
filter(
YEAR >= input$year[1],
YEAR <= input$year[2]
) %>%
group_by(crime_type) %>%
summarise(total = sum(crime_count), .groups = "drop") %>%
arrange(desc(total)) %>%
slice_head(n = 10) %>%
ggplot(aes(reorder(crime_type, total), total)) +
geom_col(fill = "darkorange") +
coord_flip() +
labs(
x = "Crime Type",
y = "Total Crimes"
) +
theme_minimal()
})
# ------------------------------------------
# 3. State-wise crime trend
# ------------------------------------------
output$stateTrendPlot <- renderPlot({
filtered_data() %>%
group_by(YEAR) %>%
summarise(total = sum(crime_count), .groups = "drop") %>%
ggplot(aes(YEAR, total)) +
geom_line(color = "steelblue", linewidth = 1) +
geom_point() +
scale_x_continuous(breaks = sort(unique(crime$YEAR))) +
labs(
x = "Year",
y = "Total Crimes"
) +
theme_minimal()
})
# ------------------------------------------
# 4. Crime type distribution (state)
# ------------------------------------------
output$stateCrimeTypePlot <- renderPlot({
filtered_data() %>%
group_by(crime_type) %>%
summarise(total = sum(crime_count), .groups = "drop") %>%
arrange(desc(total)) %>%
slice_head(n = 10) %>%
ggplot(aes(reorder(crime_type, total), total)) +
geom_col(fill = "seagreen") +
coord_flip() +
labs(
x = "Crime Type",
y = "Total Crimes"
) +
theme_minimal()
})
}
# --------------------------------------------
# Run App
# --------------------------------------------
shinyApp(ui = ui, server = server)
# ============================================
# app.R
# NCRB Crime Analysis Dashboard (Final Dataset)
# ============================================
library(shiny)
library(tidyverse)
library(ggplot2)
# --------------------------------------------
# Load cleaned crime dataset
# --------------------------------------------
crime <- read_csv("data/cleaned_crime_data.csv", show_col_types = FALSE)
# --------------------------------------------
# UI
# --------------------------------------------
ui <- fluidPage(
titlePanel("India Crime Analysis Dashboard (NCRB Data)"),
sidebarLayout(
sidebarPanel(
selectInput(
"state",
"Select State / UT:",
choices = sort(unique(crime$`STATE/UT`)),
selected = unique(crime$`STATE/UT`)[1]
),
selectInput(
"crime_type",
"Select Crime Type:",
choices = c("All", sort(unique(crime$crime_type))),
selected = "All"
),
sliderInput(
"year",
"Select Year Range:",
min = min(crime$YEAR),
max = max(crime$YEAR),
value = c(min(crime$YEAR), max(crime$YEAR)),
sep = ""
)
),
mainPanel(
tabsetPanel(
tabPanel(
"Overview",
h4("Year-wise Crime Trend (India)"),
plotOutput("yearPlot", height = "350px"),
br(),
h4("Top Crime Types"),
plotOutput("crimeTypePlot", height = "350px")
),
tabPanel(
"State-wise Analysis",
h4("Crime Trend for Selected State"),
plotOutput("stateTrendPlot", height = "350px"),
br(),
h4("Crime Distribution by Type"),
plotOutput("stateCrimeTypePlot", height = "350px")
)
)
)
)
)
# --------------------------------------------
# Server
# --------------------------------------------
server <- function(input, output) {
# Reactive filtered dataset
filtered_data <- reactive({
data <- crime %>%
filter(
`STATE/UT` == input$state,
YEAR >= input$year[1],
YEAR <= input$year[2]
)
if (input$crime_type != "All") {
data <- data %>% filter(crime_type == input$crime_type)
}
data
})
# ------------------------------------------
# 1. Year-wise crime trend (India)
# ------------------------------------------
output$yearPlot <- renderPlot({
crime %>%
filter(
YEAR >= input$year[1],
YEAR <= input$year[2]
) %>%
group_by(YEAR) %>%
summarise(total = sum(crime_count), .groups = "drop") %>%
ggplot(aes(YEAR, total)) +
geom_line(color = "firebrick", linewidth = 1) +
geom_point() +
scale_x_continuous(breaks = sort(unique(crime$YEAR))) +
labs(
x = "Year",
y = "Total Crimes"
) +
theme_minimal()
})
# ------------------------------------------
# 2. Top crime types (India)
# ------------------------------------------
output$crimeTypePlot <- renderPlot({
crime %>%
filter(
YEAR >= input$year[1],
YEAR <= input$year[2]
) %>%
group_by(crime_type) %>%
summarise(total = sum(crime_count), .groups = "drop") %>%
arrange(desc(total)) %>%
slice_head(n = 10) %>%
ggplot(aes(reorder(crime_type, total), total)) +
geom_col(fill = "darkorange") +
coord_flip() +
labs(
x = "Crime Type",
y = "Total Crimes"
) +
theme_minimal()
})
# ------------------------------------------
# 3. State-wise crime trend
# ------------------------------------------
output$stateTrendPlot <- renderPlot({
filtered_data() %>%
group_by(YEAR) %>%
summarise(total = sum(crime_count), .groups = "drop") %>%
ggplot(aes(YEAR, total)) +
geom_line(color = "steelblue", linewidth = 1) +
geom_point() +
scale_x_continuous(breaks = sort(unique(crime$YEAR))) +
labs(
x = "Year",
y = "Total Crimes"
) +
theme_minimal()
})
# ------------------------------------------
# 4. Crime type distribution (state)
# ------------------------------------------
output$stateCrimeTypePlot <- renderPlot({
filtered_data() %>%
group_by(crime_type) %>%
summarise(total = sum(crime_count), .groups = "drop") %>%
arrange(desc(total)) %>%
slice_head(n = 10) %>%
ggplot(aes(reorder(crime_type, total), total)) +
geom_col(fill = "seagreen") +
coord_flip() +
labs(
x = "Crime Type",
y = "Total Crimes"
) +
theme_minimal()
})
}
# --------------------------------------------
# Run App
# --------------------------------------------
shinyApp(ui = ui, server = server)
